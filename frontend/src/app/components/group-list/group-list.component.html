<div class="groups-container">
  <!-- Header Section -->
  <div class="groups-header">
    <div class="header-content">
      <h1 class="page-title">
        <mat-icon>groups</mat-icon>
        My Groups
      </h1>
      <button mat-raised-button color="primary" (click)="onCreateGroup()">
        <mat-icon>add</mat-icon>
        Create Group
      </button>
    </div>
  </div>

  <!-- Groups Content -->
  <div class="groups-content">
    <!-- Loading State -->
    <div class="loading-container" *ngIf="loading">
      <mat-spinner></mat-spinner>
      <p>Loading your groups...</p>
    </div>

    <!-- Groups List -->
    <div class="groups-list" *ngIf="!loading && groups.length > 0">
      <mat-card class="group-card" *ngFor="let group of groups" (click)="onGroupClick(group)">
        <mat-card-header>
          <div mat-card-avatar class="group-avatar">
            <img [src]="group.iconUrl" [alt]="group.name" />
          </div>
          <mat-card-title>{{ group.name }}</mat-card-title>
          <mat-card-subtitle>{{ group.description }}</mat-card-subtitle>
          
          <!-- Card Actions -->
          <div class="card-actions">
            <button mat-icon-button [matMenuTriggerFor]="groupMenu" (click)="$event.stopPropagation()">
              <mat-icon>more_vert</mat-icon>
            </button>
            <mat-menu #groupMenu="matMenu">
              <button mat-menu-item (click)="onGroupClick(group)">
                <mat-icon>visibility</mat-icon>
                <span>View Details</span>
              </button>
              <button mat-menu-item (click)="onSettleUp(group)">
                <mat-icon>payment</mat-icon>
                <span>Settle Up</span>
              </button>
              <mat-divider></mat-divider>
              <button mat-menu-item (click)="onDeleteGroup(group)" class="delete-action">
                <mat-icon>delete</mat-icon>
                <span>Delete Group</span>
              </button>
            </mat-menu>
          </div>
        </mat-card-header>

        <mat-card-content>
          <div class="group-stats">
            <div class="stat-item">
              <mat-icon>people</mat-icon>
              <span>{{ group.memberCount }} members</span>
            </div>
            <div class="stat-item">
              <mat-icon>receipt</mat-icon>
              <span>${{ group.totalExpenses.toFixed(2) }} total</span>
            </div>
            <div class="stat-item">
              <mat-icon>account_balance_wallet</mat-icon>
              <span class="balance" [ngClass]="getBalanceColor(group.yourBalance)">
                {{ getBalanceText(group.yourBalance) }}
              </span>
            </div>
          </div>
          
          <div class="group-meta">
            <span class="created-date">Created {{ formatDate(group.createdAt) }}</span>
          </div>
        </mat-card-content>

        <mat-card-actions>
          <button mat-button color="primary" (click)="onGroupClick(group); $event.stopPropagation()">
            VIEW EXPENSES
          </button>
          <button 
            mat-button 
            [color]="group.yourBalance !== 0 ? 'accent' : 'primary'"
            (click)="onSettleUp(group); $event.stopPropagation()"
          >
            {{ group.yourBalance !== 0 ? 'SETTLE UP' : 'SETTLED' }}
          </button>
        </mat-card-actions>
      </mat-card>
    </div>

    <!-- Empty State -->
    <div class="empty-state" *ngIf="!loading && groups.length === 0">
      <mat-card class="empty-card">
        <mat-card-content>
          <div class="empty-content">
            <mat-icon class="empty-icon">groups</mat-icon>
            <h2>No groups yet</h2>
            <p>Create your first group to start splitting expenses with friends and family.</p>
            <button mat-raised-button color="primary" (click)="onCreateGroup()">
              <mat-icon>add</mat-icon>
              Create Your First Group
            </button>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>